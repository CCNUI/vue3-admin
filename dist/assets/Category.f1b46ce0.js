import"./vendor.ebc30097.js";/* empty css             *//* empty css               *//* empty css              */import{_ as e,r as a,u as r,g as t,o,c as l,w as n,a as s,f as i,q as c,C as d,K as u,h as p,i as g,l as m,j as y,L as v,v as f,d as b,U as _,e as h,M as k,N as C,O as x,P as I,E as F,R as j,S as w,T as L}from"./index.c118f695.js";/* empty css                  *//* empty css                     *//* empty css                 *//* empty css                   *//* empty css                *//* empty css                  */const S={class:"dialog-footer"};var V=e({__name:"DialogAddCategory",props:{type:String,reload:Function},setup(e,{expose:f}){const b=e,_=a(null),h=r(),k=t({visible:!1,categoryLevel:1,parentId:0,ruleForm:{name:"",rank:""},rules:{name:[{required:"true",message:"名称不能为空",trigger:["change"]}],rank:[{required:"true",message:"编号不能为空",trigger:["change"]}]},id:""}),C=()=>{_.value.validate((e=>{e&&("add"==b.type?d.post("/categories",{categoryLevel:k.categoryLevel,parentId:k.parentId,categoryName:k.ruleForm.name,categoryRank:k.ruleForm.rank}).then((()=>{u.success("新增成功"),k.visible=!1,b.reload&&b.reload()})):d.put("/categories",{categoryId:k.id,categoryLevel:k.categoryLevel,parentId:k.categoryLevel,categoryName:k.ruleForm.name,categoryRank:k.ruleForm.rank}).then((()=>{u.success("修改成功"),k.visible=!1,b.reload&&b.reload()})))}))};return f({open:e=>{if(k.visible=!0,e)k.id=e,(e=>{d.get(`/categories/${e}`).then((e=>{k.ruleForm={name:e.categoryName,rank:e.categoryRank},k.parentId=e.parentId,k.categoryLevel=e.categoryLevel}))})(e);else{const{level:e=1,parent_id:a=0}=h.query;k.ruleForm={name:"",rank:""},k.parentId=a,k.categoryLevel=e}},close:()=>{k.visible=!1}}),(e,a)=>{const r=p,t=g,d=m,u=y,f=v;return o(),l(f,{title:"add"==k.type?"新增类目":"修改类目",modelValue:k.visible,"onUpdate:modelValue":a[3]||(a[3]=e=>k.visible=e),width:"400px"},{footer:n((()=>[s("span",S,[i(u,{onClick:a[2]||(a[2]=e=>k.visible=!1)},{default:n((()=>[c("取 消")])),_:1}),i(u,{type:"primary",onClick:C},{default:n((()=>[c("确 定")])),_:1})])])),default:n((()=>[i(d,{model:k.ruleForm,rules:k.rules,ref_key:"formRef",ref:_,"label-width":"100px",class:"good-form"},{default:n((()=>[i(t,{label:"商品名称",prop:"name"},{default:n((()=>[i(r,{type:"text",modelValue:k.ruleForm.name,"onUpdate:modelValue":a[0]||(a[0]=e=>k.ruleForm.name=e)},null,8,["modelValue"])])),_:1}),i(t,{label:"序号",prop:"rank"},{default:n((()=>[i(r,{type:"number",modelValue:k.ruleForm.rank,"onUpdate:modelValue":a[1]||(a[1]=e=>k.ruleForm.rank=e)},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["title","modelValue"])}}},[["__file","C:/Users/HDR10/source/repos/vue3-admin/src/components/DialogAddCategory.vue"]]);const R={class:"header"},z=["onClick"],D=["onClick"],P=s("a",{style:{cursor:"pointer"}},"删除",-1);var T=e({__name:"Category",setup(e){const p=a(null),g=f(),m=r(),v=t({loading:!1,tableData:[],multipleSelection:[],total:0,currentPage:1,pageSize:10,type:"add",level:1,parent_id:0});b((()=>{T()})),_((()=>{console.log(v.pageSize)}));const S=g.afterEach((e=>{["category","level2","level3"].includes(e.name)&&T()}));h((()=>{S()}));const T=()=>{const{level:e=1,parent_id:a=0}=m.query;v.loading=!0,d.get("/categories",{params:{pageNumber:v.currentPage,pageSize:v.pageSize,categoryLevel:e,parentId:a}}).then((r=>{v.tableData=r.list,v.total=r.totalCount,v.currentPage=r.currPage,v.loading=!1,v.level=e,v.parentId=a}))},q=e=>{v.currentPage=e,T()},N=()=>{v.type="add",p.value.open()},U=e=>{v.multipleSelection=e},B=()=>{v.multipleSelection.length?d.delete("/categories",{data:{ids:v.multipleSelection.map((e=>e.categoryId))}}).then((()=>{u.success("删除成功"),T()})):u.error("请选择项")};return(e,a)=>{const r=y,t=k,m=C,f=x,b=I,_=F;return o(),l(_,{class:"category-container"},{header:n((()=>[s("div",R,[i(r,{type:"primary",icon:j(w),onClick:N},{default:n((()=>[c("增加")])),_:1},8,["icon"]),i(t,{title:"确认删除吗？",confirmButtonText:"确认",cancelButtonText:"取消",onConfirm:B},{reference:n((()=>[i(r,{type:"danger",icon:j(L)},{default:n((()=>[c("批量删除")])),_:1},8,["icon"])])),_:1})])])),default:n((()=>[i(f,{load:v.loading,ref:"multipleTable",data:v.tableData,"tooltip-effect":"dark",style:{width:"100%"},onSelectionChange:U},{default:n((()=>[i(m,{type:"selection",width:"55"}),i(m,{prop:"categoryName",label:"类目名称"}),i(m,{prop:"categoryRank",label:"序号",width:"120"}),i(m,{prop:"createTime",label:"新增时间戳",width:"200"}),i(m,{label:"操作",width:"220"},{default:n((e=>[s("a",{style:{cursor:"pointer","margin-right":"10px"},onClick:a=>{return r=e.row.categoryId,v.type="edit",void p.value.open(r);var r}},"修改",8,z),s("a",{style:{cursor:"pointer","margin-right":"10px"},onClick:a=>(e=>{const a=e.categoryLevel+1;4!=a?g.push({name:`level${a}`,query:{level:a,parent_id:e.categoryId}}):u.error("没有下一级")})(e.row)},"下级分类",8,D),i(t,{title:"确认删除吗？",confirmButtonText:"确认",cancelButtonText:"取消",onConfirm:a=>{return r=e.row.categoryId,void d.delete("/categories",{data:{ids:[r]}}).then((()=>{u.success("删除成功"),T()}));var r}},{reference:n((()=>[P])),_:2},1032,["onConfirm"])])),_:1})])),_:1},8,["load","data"]),i(b,{background:"",layout:"prev, pager, next",total:v.total,"page-size":v.pageSize,"current-page":v.currentPage,onCurrentChange:q},null,8,["total","page-size","current-page"]),i(V,{ref_key:"addCate",ref:p,reload:T,type:v.type},null,8,["type"])])),_:1})}}},[["__file","C:/Users/HDR10/source/repos/vue3-admin/src/views/Category.vue"]]);export{T as default};
